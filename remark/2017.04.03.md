name: inverse
layout: true
class: underscore

---
class: center, middle, hero

.title[
  # 시스템 트레이딩
  ## with python

  https://github.com/jacegem/system-trading-python
]

???

스피커 노트

Speaker notes go after ???

Toggle speaker view by pressing P

Pressing C clones the slideshow view,
which is the view to put on the projector
if you're using speaker view.

Press ? to toggle keyboard commands help.

---

# 차례

1. 전략을 세웁니다.

2. PyQt 를 이용해서 GUI로 구성합니다.

3. 데이터를 조회합니다. (야후 파이넨스)

4. 시뮬레이션을 합니다.

5. 앞으로 할 일

---

# 전략

단순하게 해 보았습니다.

Adj Close 값을 기준으로 전략을 세웠습니다

- 전날보다 오르면 `구매`
- 전날보다 내리면 `판매`

물론, `실패`하는 전략입니다


---

# PyQt

```
import sys
from PyQt5.QtWidgets import *

class MyMainWindow(QMainWindow):
    def __init__(self, parent=None):
        super(MyMainWindow, self).__init__(parent)
        self.form_widget = FormWidget(self)
        self.setCentralWidget(self.form_widget)
        self.statusBar().showMessage('Ready')

    def changeStatusBar(self, msg):
        self.statusBar().showMessage(msg)

class FormWidget(QWidget):
    def __init__(self, parent):
        super(FormWidget, self).__init__(parent)

if __name__ == "__main__":
    app = QApplication([])
    dialog = MyMainWindow()
    dialog.show()
    sys.exit(app.exec_())
```

---

# PyQt

실행 결과

![](https://content.screencast.com/users/beneapp/folders/Snagit/media/2bf4c83a-067a-44f3-9b31-36b2fe1291ba/2017-04-02_22-26-48.png)

---

# PyQt

이 곳에 필요한 내용 요소들을 입력합니다.

- 조회하려는 코드
- 보유 최대 금액
- 시작날짜
- 종료날짜

--

![](https://content.screencast.com/users/beneapp/folders/Snagit/media/18b3bdf8-b44c-49ed-aee4-2cc7ad6b11c6/2017-04-02_22-33-22.png)


---

# PyQt


```
class FormWidget(QWidget):
    def __init__(self, parent):
        super(FormWidget, self).__init__(parent)
```

위 코드 안에 필요한 요소들을 넣어서 생성합니다.

---

# PyQt

```
def __init__(self, parent):
    super(FormWidget, self).__init__(parent)

    self.gridLayout = QGridLayout(self)

    # 대상 (코드)
    # 시작날짜
    # 종료날짜
    # 종목 최대 보유금액

    self.gridRow = 0
    self.gridCol = 0

    # 대상 (코드)
    self.editCode = QLineEdit()
    self.gridLayout.addWidget(self.editCode, self.add_row(), 0)
    self.editCode.setText('A023350')

    # 투자 최대 금액
    self.editMoneyMax = QLineEdit()
    self.gridLayout.addWidget(self.editMoneyMax, self.add_row(), 0)
    self.editMoneyMax.setText('1000000')
```

---


```
    # 시작날짜
    self.dateStart = QDateEdit()
    self.gridLayout.addWidget(self.dateStart, self.add_row(), 0)
    self.startDate = QDate(2017,1,1)
    self.dateStart.setDate(self.startDate)

    # 종료날짜
    self.dateEnd = QDateEdit()
    self.gridLayout.addWidget(self.dateEnd, self.add_row(), 0)
    self.endDate = QDate(QDate.currentDate())
    self.dateEnd.setDate(self.endDate)

    # 시작 버튼
    self.btnStart = QPushButton("데이터 가져오기")
    self.btnStart.clicked.connect(self.get_stock_data)
    self.gridLayout.addWidget(self.btnStart, self.add_row(), 0)

    # 분석 버튼
    self.btnStart = QPushButton("분석")
    self.btnStart.clicked.connect(self.start_simulator)
    self.gridLayout.addWidget(self.btnStart, self.add_row(), 0)

    # 결과 창
    self.logOutput = QTextEdit(parent)
    self.logOutput.setReadOnly(True)
    self.logOutput.setFixedWidth(800)
    self.logOutput.setLineWrapMode(QTextEdit.NoWrap)
    self.gridLayout.addWidget(self.logOutput, self.init_row(), self.add_col(), 6, 1)
```


---

# PyQt

최초에 GUI가 보이게 되면 데이터를 조회하도록 하였습니다.


앞 장에서 보았던 FormWidget 클래스 안에 정의하였습니다.


```
class FormWidget(QWidget):
...
    def showEvent(self, QShowEvent):
        """시작하면 데이터를 가져온다."""
        self.get_stock_data()
...
```

---

# PyQt

입력된 데이터를 읽어와서 조회를 합니다.


```
def get_stock_data(self):
    self.code = self.editCode.text()
    money_max = self.editMoneyMax.text()
    self.start_datetime = self.get_datetime(self.dateStart.date())
    self.end_datetime = self.get_datetime(self.dateEnd.date())

    # 데이터 가져오기
    item_list = []
    item_list.append({'code': self.code, 'name': '테스트대상'})
    self.data_manager = DataManager(self.start_datetime, self.end_datetime)
    self.data_manager.set_item_list(item_list)

    # 계정 관리자
    self.account_manager = AccountManager(money_max, self.data_manager)
```

---

# PyQt

데이터 관리를 위한 클래스입니다

```
class DataManager:
    # 시작일, 종료일,
    def __init__(self, start_date, end_date):
        self.item_list = {}     # 아이템 목록
        self.data_source = 'yahoo'
        self.start_date = start_date - timedelta(days=200)
        self.end_date = end_date
        self.item_datas = {}    # 아이템 결과 데이터
        self.stock_datas = {}

    def set_item_list(self, item_list):
        """가져올 대상 아이템(주식코드)들을 지정한다."""
        # itemList
        # item['code'], item['name']
        task = Tasks(item_list, self.start_date, self.end_date)
        self.stock_datas = task.start()
```


---

class: animated fadeIn

<div style="position: absolute; top:0; left: 0; width: 100%; height: 100%; color:red; font-size: 10em; text-align: center">
 &#x2717;
</div>

# Code

```
case class Wibble(x: Throwable \/ Long) {
  def answer = 42
}

val f: Int => String =
  x.toString
```

---

# Table Listing Dogs

| Breed            | Superpower    | Weight (kg) |
|:-----------------|:-------------:| -------:|
| Springer Spaniel | Wagging       |    24 |
| GSP              | Floppy Ears   |    27 |
| Jack Russell     | Sleeping      |     8 |

---
class: center

# Pictures &amp; Title

<img src="screengrab.png" width="97%" alt="screen grab">

---
background-image: url(screengrab.png)

???

That's the best I can find for a full-page image.
The repeat may just be an issue with remark, [#211](https://github.com/gnab/remark/issues/211), specifically.

---
class: center, middle

> “I refuse to answer that question on the grounds that I don't know the answer”

— Douglas Adams


---
class: center, middle, hero

.title[
  # Thank You
  ## Richard Dallaway, [@d6y](http://twitter.com/d6y)
  ### http://underscore.io/

  [![Underscore Logo](img/white-logo.png)](http://underscore.io/)
]